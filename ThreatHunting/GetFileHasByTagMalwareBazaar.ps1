# API Endpoint
$apiEndpoint = "https://mb-api.abuse.ch/api/v1/"

$postData = @{
    query = "get_taginfo"
    tag = "DarkGate"
    limit = 50
}

# Send GET-Request to API Endpoint
$response = Invoke-RestMethod -Uri $apiEndpoint -Method Post -Body $postData

# API-Response
if ($response) {
        Write-Host "API-response recieved:"
        Write-Host $response
} else {
    Write-Host "Error."
}

$response | select-object sha254_hash

# Opret en liste til at gemme sha256_hash-værdier
$sha256HashValues = @()

# Gennemgå hvert element i $response og udtræk sha256_hash-værdien
foreach ($entry in $response) {
    $sha256Hash = $entry.sha256_hash
    if ($sha256Hash -ne $null) {
        $sha256HashValues += $sha256Hash
    }
}

# Vis de udtrukne sha256_hash-værdier
$sha256HashValues